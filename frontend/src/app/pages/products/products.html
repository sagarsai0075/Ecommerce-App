<div class="page-layout">

  <!-- LEFT FILTER -->
  <aside class="filter-panel" aria-label="Product filters">

    <div class="filter-header">
      <h3>Filters</h3>
      <button type="button" class="clear-filters" title="Clear all filters" aria-label="Clear all filters">Clear</button>
    </div>

    <form class="filters" (submit)="$event.preventDefault()">

      <!-- SORT -->
      <div class="filter-block">
        <h4>Sort By</h4>

        <label for="sort-newest">
          <input id="sort-newest" type="radio" name="sort" value="newest" />
          Newest First
        </label>

        <label for="sort-low">
          <input id="sort-low" type="radio" name="sort" value="low" />
          Price: Low to High
        </label>

        <label for="sort-high">
          <input id="sort-high" type="radio" name="sort" value="high" />
          Price: High to Low
        </label>
      </div>

      <hr />

      <!-- PRICE RANGE -->
      <div class="filter-block">
        <h4>Price Range</h4>

        <label for="p1">
          <input id="p1" type="checkbox" name="price" value="0-500" />
          ₹0 – ₹500
        </label>

        <label for="p2">
          <input id="p2" type="checkbox" name="price" value="500-1000" />
          ₹500 – ₹1,000
        </label>

        <label for="p3">
          <input id="p3" type="checkbox" name="price" value="1000-2000" />
          ₹1,000 – ₹2,000
        </label>

        <label for="p4">
          <input id="p4" type="checkbox" name="price" value="2000-5000" />
          ₹2,000 – ₹5,000
        </label>

        <label for="p5">
          <input id="p5" type="checkbox" name="price" value="5000+" />
          ₹5,000 &amp; Above
        </label>
      </div>

      <hr />

      <!-- BRAND -->
      <div class="filter-block">
        <h4>Brand</h4>

        <label for="b-samsung"><input id="b-samsung" type="checkbox" name="brand" value="Samsung" /> Samsung</label>
        <label for="b-apple"><input id="b-apple" type="checkbox" name="brand" value="Apple" /> Apple</label>
        <label for="b-oneplus"><input id="b-oneplus" type="checkbox" name="brand" value="OnePlus" /> OnePlus</label>
        <label for="b-redmi"><input id="b-redmi" type="checkbox" name="brand" value="Redmi" /> Redmi</label>
        <label for="b-vivo"><input id="b-vivo" type="checkbox" name="brand" value="Vivo" /> Vivo</label>
      </div>

      <hr />

      <!-- CUSTOMER RATING -->
      <div class="filter-block">
        <h4>Customer Ratings</h4>

        <label for="r4"><input id="r4" type="checkbox" name="rating" value="4" /> ⭐⭐⭐⭐ &amp; above</label>
        <label for="r3"><input id="r3" type="checkbox" name="rating" value="3" /> ⭐⭐⭐ &amp; above</label>
        <label for="r2"><input id="r2" type="checkbox" name="rating" value="2" /> ⭐⭐ &amp; above</label>
      </div>

    </form>
  </aside>


  <!-- RIGHT CONTENT -->
  <section class="content" aria-live="polite">

    <!-- header removed to align products with filters -->

    <div class="products-list">
      <div class="product-card" *ngFor="let p of products; let i = index" role="article" [attr.aria-labelledby]="'product-title-' + i">

        <!-- IMAGE -->
        <div class="img-box">
          <img [src]="p.image" [alt]="p.name || 'Product image'" />
        </div>

        <!-- DETAILS -->
        <div class="info-box">

          <div class="top-row">
            <span class="sponsored" *ngIf="p.sponsored">Sponsored</span>
          </div>

          <h3 id="product-title-{{ i }}">{{ p.name }}</h3>

          <div class="rating" aria-hidden="true">
            ⭐ {{ p.rating || '4.3' }} <span>{{ p.reviewsCount || '89' }} Ratings</span>
          </div>

          <ul>
            <li *ngFor="let feat of (p.features || ['Feature rich', 'Warranty included'])">{{ feat }}</li>
          </ul>

          <label class="compare" [attr.for]="'compare-' + i">
            <input id="compare-{{ i }}" type="checkbox" />
            <span>Add to Compare</span>
          </label>

        </div>

        <!-- PRICE -->
        <div class="price-box">

          <div class="price">₹{{ getFinalPrice(p) }}</div>

          <div class="old" *ngIf="p.discount">
            ₹{{ p.price }}
          </div>

          <div class="off" *ngIf="p.discount">
            {{ p.discount }}% off
          </div>

          <button type="button" (click)="addToCart(p)" aria-label="Add {{ p.name }} to cart">Add to Cart</button>

        </div>

      </div>
    </div>

  </section>

</div>
